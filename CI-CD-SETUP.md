# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD –¥–ª—è Laravel MockExam –ø—Ä–æ–µ–∫—Ç–∞

## –û–±–∑–æ—Ä

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è CI/CD —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è Laravel + PostgreSQL + Redis + Docker –ø—Ä–æ–µ–∫—Ç–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Å–±–æ—Ä–∫–æ–π –∏ –¥–µ–ø–ª–æ–µ–º.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Workflows

### 1. `ci.yml` - –û—Å–Ω–æ–≤–Ω–æ–π CI/CD pipeline
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
- –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ staging/production
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

### 2. `pr-checks.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è Pull Request'–æ–≤
- –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ PHP
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 3. `security.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- CodeQL –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
- –ü–æ–∏—Å–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Docker –æ–±—Ä–∞–∑–æ–≤

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### GitHub Secrets
–î–æ–±–∞–≤—å —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

#### –î–ª—è Staging
- `STAGING_SSH_KEY` - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ staging —Å–µ—Ä–≤–µ—Ä—É
- `STAGING_USER` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ staging —Å–µ—Ä–≤–µ—Ä–µ
- `STAGING_HOST` - IP –∏–ª–∏ –¥–æ–º–µ–Ω staging —Å–µ—Ä–≤–µ—Ä–∞
- `STAGING_PATH` - –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ staging —Å–µ—Ä–≤–µ—Ä–µ

#### –î–ª—è Production
- `PRODUCTION_SSH_KEY` - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ production —Å–µ—Ä–≤–µ—Ä—É
- `PRODUCTION_USER` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ
- `PRODUCTION_HOST` - IP –∏–ª–∏ –¥–æ–º–µ–Ω production —Å–µ—Ä–≤–µ—Ä–∞
- `PRODUCTION_PATH` - –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `DB_PASSWORD` - –ü–∞—Ä–æ–ª—å –¥–ª—è PostgreSQL

### GitHub Variables
–î–æ–±–∞–≤—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

- `STAGING_URL` - URL staging –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://staging.yourapp.com)
- `PRODUCTION_URL` - URL production –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://yourapp.com)

### Environments
–°–æ–∑–¥–∞–π environments –≤ GitHub:
1. `staging` - –¥–ª—è staging –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. `production` - –¥–ª—è production –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å –∑–∞—â–∏—Ç–æ–π –∏ approval)

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∏ Docker Compose –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–∞ (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ)
ssh-keygen -t rsa -b 4096 -C "deploy@yourapp.com"

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id user@your-server.com
```

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```
/var/www/yourapp/
‚îú‚îÄ‚îÄ docker-compose.staging.yml (–∏–ª–∏ docker-compose.prod.yml)
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ storage/
‚îú‚îÄ‚îÄ bootstrap/cache/
‚îî‚îÄ‚îÄ ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞)
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–µ–ø–ª–æ–π –Ω–∞ Staging
1. –°–æ–∑–¥–∞–π Pull Request –≤ –≤–µ—Ç–∫—É `develop`
2. –ü–æ—Å–ª–µ merge –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –¥–µ–ø–ª–æ–π –Ω–∞ staging

### –î–µ–ø–ª–æ–π –Ω–∞ Production
1. –°–æ–∑–¥–∞–π Pull Request –≤ –≤–µ—Ç–∫—É `main`
2. –ü–æ—Å–ª–µ merge –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –¥–µ–ø–ª–æ–π –Ω–∞ production

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ü—Ä–æ–≤–µ—Ä—è–π —Å—Ç–∞—Ç—É—Å deployments –≤ —Ä–∞–∑–¥–µ–ª–µ Actions
- Health checks –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å–∞–º:
  - `/up` - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Laravel health check
  - `/health` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π health check —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤
  - `/api/health` - API health check

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ —Å Laravel Sail
```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
./vendor/bin/sail up -d
./vendor/bin/sail artisan migrate:fresh --seed

# –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞
./vendor/bin/sail up -d
./vendor/bin/sail artisan test
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞
```bash
./vendor/bin/sail artisan pint
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
./vendor/bin/sail artisan test
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å Docker Registry
–£–±–µ–¥–∏—Å—å —á—Ç–æ GitHub Token –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ packages:write

### –ü—Ä–æ–±–ª–µ–º—ã —Å SSH
–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ SSH –∫–ª—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ docker –∫–æ–º–∞–Ω–¥

### –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
–£–±–µ–¥–∏—Å—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Slack/Discord
–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –∏ –Ω–∞—Å—Ç—Ä–æ–π —Å–µ–∫—Ü–∏–∏ notify –≤ workflows

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
Workflow `performance.yml` –≤–∫–ª—é—á–∞–µ—Ç Lighthouse –∏ K6 —Ç–µ—Å—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
Workflow `security.yml` –≤–∫–ª—é—á–∞–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∫–æ–¥–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub
```bash
# –ó–∞–π–¥–∏ –≤ GitHub ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
# –î–æ–±–∞–≤—å —Å–µ–∫—Ä–µ—Ç—ã (—Å–º. —Ä–∞–∑–¥–µ–ª "GitHub Secrets" –≤—ã—à–µ)
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –°–∫–∞—á–∞–π –∏ –∑–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
curl -O https://raw.githubusercontent.com/AIAnsar1/MockExam/main/scripts/setup-server.sh
chmod +x setup-server.sh
./setup-server.sh staging  # –∏–ª–∏ production
```

### 3. –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π
```bash
# Push –≤ develop –¥–ª—è staging
git push origin develop

# Push –≤ main –¥–ª—è production  
git push origin main
```

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

‚úÖ **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PR** ‚Üí –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏  
‚úÖ **–ü—Ä–∏ push –≤ develop** ‚Üí –ø–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã + –¥–µ–ø–ª–æ–π –Ω–∞ staging  
‚úÖ **–ü—Ä–∏ push –≤ main** ‚Üí –ø–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã + –¥–µ–ø–ª–æ–π –Ω–∞ production  
‚úÖ **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏  
‚úÖ **–ü—Ä–∏ –∫–∞–∂–¥–æ–º push** ‚Üí —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Docker –æ–±—Ä–∞–∑–æ–≤  

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### Health Check endpoints:
- `/up` - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Laravel health check
- `/health` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose -f docker-compose.staging.yml logs -f

# –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π
./deploy-staging.sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl restart mockexam-staging
```

## –ì–æ—Ç–æ–≤–æ! üéâ

–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è CI/CD —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è Laravel –ø—Ä–æ–µ–∫—Ç–∞!